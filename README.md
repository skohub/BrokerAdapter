# BrokerAdapter

Идея проекта в том, чтобы превратить синхронный HTTP-запрос в асинхронный запрос через очередь сообщений.

Одинаковые HTTP-запросы группируются и отправляются в очередь сообщений (MQ) только один раз. Например:

1) Приходит запрос /api/value/1. Т.к. очереди на подобный запрос еще нет, она создается и отправляется сообщение в MQ (endpoint: /api/value, parameters: 1)
2) Снова приходит запрос /api/value/1, запрос добавляется в существующую очередь, сообщение в MQ не посылается. При этом HTTP-клиент синхронно ожидает ответа.
3) Приходит ответ из MQ и сразу рассылается всем ожидающим клиентам, при условии, что у них еще не вышел timeout.

## Реализация MQ через файловую систему

В тестовых целях очередь сообщений реализована при помощи папок и файлов.

*Publish* - создание файла в папке с запросами, название файла - хэш от url + http verb.

*Retrieve* - чтение файла из папки ответов с таким же названием, как и у запроса. Если на момент чтения файл не существует, то файловая система будет поллиться, пока файл не появится.
